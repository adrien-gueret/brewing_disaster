import initZZFX, {
  generateMusic,
  playMusic,
  playSound,
  toggle,
} from "./zzfx.js";
import { toggleMuteSounds } from "./state.js";
import { toggleSoundsCheckbox, onSoundsCheckboxChange } from "./ui.js";

const mainMusic = generateMusic([
  [
    [
      2,
      0,
      261.6255653005986,
      ,
      1,
      ,
      1,
      ,
      ,
      ,
      ,
      ,
      0.2,
      ,
      ,
      ,
      0.01,
      0.5,
      0.01,
      0.2,
    ],
    [, 0, 130.8127826502993, , 1, , , 2, , , 0.5, , , , , 0.1, , 0.4, 0.05],
    [1.3, 0, 65.40639132514966, , 0.02, , , 1.5, , , , , , 5, , , , 0.7, 0.02],
    [0.5, 0, 260, , , 0.04, , , , , , , 0.1, 99, , , , 2, 0.005, 0.2],
  ],
  [
    [
      [
        0, 0, 18, -1, 14, 19, 14, -1, 16, 19, 16, -1, 18, -1, 14, -1, 18, -1,
        16, 19, 14, -1, 14, 19, 16, -1, 18, -1, 14, -1, 18, -1, 16, 19, 16, -1,
        14, 19, 14, -1, 18, -1, 16, -1, 18, 24, 14, 26, 26, -1, 24, 19, 14, -1,
        18, -1, 16, -1, 18, -1, 14, 19, 14, 24, 16, 26, 26, -1, 24, -1, 29, 0,
        0, 0, 16, 19, 14, -1, 14, 19, 16, -1, 18, -1, 14, -1, 18, -1, 16, 19,
        16, -1, 14, 19, 14, -1, 18, -1, 16, -1, 18, -1, 14, 19, 16, -1, 16, 19,
        14, -1, 18, -1, 16, -1, 18, -1, 14, 24, 14, 26, 26, 19, 24, -1, 18, -1,
        14, -1, 18, -1, 16, 19, 14, -1, 14, 24, 16, 26, 26, -1, 24, -1, 29, 0,
        0, 0, 16, -1, 14, 19, 14, -1, 18, -1, 16, -1, 18, -1, 14, 19, 16, -1,
        16, 19, 14, -1, 18, -1, 16, -1, 18, -1, 14, 19, 14, -1, 16, 19, 16, -1,
        18, -1, 14, -1, 18, -1, 16, 19, 14, 24, 14, 26, 26, -1, 24, -1, 14, -1,
        18, -1, 16, 19,
      ],
      [
        0,
        0,
        16,
        -1,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        14,
        -1,
        ,
        ,
        16,
        -1,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        16,
        -1,
        ,
        ,
        14,
        -1,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        16,
        -1,
        ,
        ,
        14,
        -1,
        ,
        19,
        16,
        -1,
        16,
        -1,
        ,
        ,
        14,
        -1,
        ,
        ,
        16,
        -1,
        ,
        ,
        ,
        ,
        ,
        19,
        16,
        -1,
        18,
        -1,
        14,
        -1,
        18,
        -1,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        16,
        -1,
        ,
        ,
        14,
        -1,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        16,
        -1,
        ,
        ,
        14,
        -1,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        14,
        -1,
        ,
        ,
        16,
        -1,
        ,
        19,
        -1,
        ,
        16,
        -1,
        16,
        -1,
        14,
        -1,
        ,
        ,
        16,
        -1,
        ,
        ,
        ,
        ,
        ,
        19,
        -1,
        ,
        18,
        -1,
        14,
        -1,
        18,
        -1,
        16,
        19,
        -1,
        ,
        ,
        ,
        ,
        ,
        16,
        -1,
        ,
        ,
        14,
        -1,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        14,
        -1,
        ,
        ,
        16,
        -1,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        14,
        -1,
        ,
        ,
        16,
        -1,
        ,
        ,
        ,
        ,
        ,
        19,
        16,
        -1,
        18,
        -1,
        ,
        ,
        14,
        -1,
        ,
      ],
      [
        0,
        0,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        14,
        -1,
        ,
        ,
        16,
        -1,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        16,
        -1,
        ,
        ,
        14,
        -1,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        ,
        16,
        -1,
        ,
        ,
        ,
        ,
        ,
      ],
      [
        1,
        0,
        ,
        19,
        18,
        -1,
        18,
        -1,
        18,
        -1,
        18,
        19,
        -1,
        19,
        -1,
        19,
        -1,
        19,
        18,
        -1,
        18,
        -1,
        18,
        -1,
        18,
        19,
        -1,
        19,
        -1,
        19,
        -1,
        19,
        18,
        -1,
        18,
        -1,
        18,
        -1,
        18,
        19,
        -1,
        19,
        -1,
        19,
        -1,
        19,
        18,
        -1,
        18,
        -1,
        18,
        -1,
        18,
        19,
        -1,
        19,
        -1,
        19,
        -1,
        19,
        18,
        -1,
        18,
        -1,
        18,
        -1,
        18,
        19,
        -1,
        19,
        -1,
        19,
        -1,
        19,
        18,
        -1,
        18,
        -1,
        18,
        -1,
        18,
        19,
        -1,
        19,
        -1,
        19,
        -1,
        19,
        18,
        -1,
        18,
        -1,
        18,
        -1,
        18,
        19,
        -1,
        19,
        -1,
        19,
        -1,
        19,
        18,
        -1,
        18,
        -1,
        18,
        -1,
        18,
        19,
        -1,
        19,
        -1,
        19,
        -1,
        19,
        18,
        -1,
        18,
        -1,
        18,
        -1,
        18,
        19,
        -1,
        19,
        -1,
        19,
        -1,
        19,
        18,
        -1,
        18,
        -1,
        18,
        -1,
        18,
        19,
        -1,
        19,
        -1,
        19,
        -1,
        19,
        18,
        -1,
        18,
        -1,
        18,
        -1,
        18,
        19,
        -1,
        19,
        -1,
        19,
        -1,
        19,
        18,
        -1,
        18,
        -1,
        18,
        -1,
        18,
        19,
        -1,
        19,
        -1,
        19,
        -1,
        19,
        18,
        -1,
        18,
        -1,
        18,
        -1,
        18,
        19,
        -1,
        19,
        -1,
        19,
        -1,
        19,
        18,
        -1,
        18,
        -1,
        18,
        -1,
        18,
        19,
        -1,
        19,
        -1,
        19,
        -1,
        19,
        18,
        -1,
      ],
    ],
  ],
  [0],
  100,
]);

const winJingle = generateMusic([
  [
    [
      2,
      0,
      261.6255653005986,
      ,
      1,
      ,
      1,
      ,
      ,
      ,
      ,
      ,
      0.2,
      ,
      ,
      ,
      0.01,
      0.5,
      0.01,
      0.2,
    ],
    [, 0, 130.8127826502993, , 1, , , 2, , , 0.5, , , , , 0.1, , 0.4, 0.05],
    [1.3, 0, 65.40639132514966, , 0.02, , , 1.5, , , , , , 5, , , , 0.7, 0.02],
    [0.5, 0, 260, , , 0.04, , , , , , , 0.1, 99, , , , 2, 0.005, 0.2],
  ],
  [[[0, 0, 24, 36, 48, 60, 0, -1]]],
  [0],
  100,
]);

export const dropPotion = () =>
  playSound([40, 0.5, , 1.5, , 11, , , , , , 199]);

export const bonusTaken = () =>
  playSound([539, 0, 0.04, 0.29, 1, 1.92, , , 567, 0.02, 0.02, , , , 0.04]);

export const battleWin = () => playMusic(winJingle);

export const battleLost = () =>
  playSound([925, 0.04, 0.3, 0.6, 1, 0.3, , 6.27, -184, 0.09, 0.17]);

export const itemThrow = () =>
  playSound([537, 0.02, 0.02, 0.22, 1, 1.59, -6.98, 4.97]);

export const click = () =>
  playSound([20, 0.02, , 0.04, 1, 3, 41, , , , , , 1, , , , , 1]);

export function toggleSounds(isMuted) {
  toggle(isMuted);
  toggleSoundsCheckbox(!isMuted);

  toggleMuteSounds(isMuted);
}

function playMainMusic() {
  playMusic(mainMusic, true);
}

export default function init(initialMuted = false) {
  initZZFX({ defaultMuted: initialMuted });
  toggleSoundsCheckbox(!initialMuted);
  playMainMusic();

  onSoundsCheckboxChange((e) => {
    toggleSounds(!e.currentTarget.checked);
  });

  document.body.addEventListener("click", (e) => {
    if (
      e.target.tagName === "A" ||
      e.target.tagName === "INPUT" ||
      e.target.tagName === "BUTTON"
    ) {
      click();
    }
  });
}
